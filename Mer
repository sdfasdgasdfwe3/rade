import os
import shutil
import subprocess
import sys

# Путь, где файл должен находиться (домашняя директория Termux)
target_path = os.path.expanduser("~") + "/Mer.py"

# Проверка текущего местоположения файла
current_path = os.path.abspath(__file__)

# Функция для перемещения файла в целевую директорию
def move_self():
    try:
        if current_path != target_path:
            print(f"Перемещаем файл из {current_path} в {target_path}...")
            shutil.move(current_path, target_path)
            print("Файл успешно перемещён. Пожалуйста, запустите его снова из Termux.")
            sys.exit()  # Завершаем выполнение после перемещения
        else:
            print("Файл уже находится в целевой директории.")
    except Exception as e:
        print(f"Ошибка при перемещении файла: {e}")

# Функция для установки библиотек
def install_dependencies():
    try:
        print("Проверяем необходимые библиотеки...")
        import requests
        print("Библиотека 'requests' уже установлена.")
    except ImportError:
        print("Устанавливаем библиотеку 'requests'...")
        subprocess.check_call([sys.executable, "-m", "pip", "install", "requests"])
        print("Библиотека 'requests' успешно установлена.")

# Основная функция выполнения задач
def main_task():
    print("Запускаем основную логику скрипта...")
    # Пример работы — проверка подключения к интернету
    try:
        import requests
        response = requests.get("https://www.google.com", timeout=5)
        if response.status_code == 200:
            print("Интернет соединение активно.")
        else:
            print("Не удалось подключиться к интернету.")
    except requests.ConnectionError:
        print("Нет подключения к интернету.")

# Основная логика
def main():
    move_self()  # Перемещаем файл, если требуется
    install_dependencies()  # Устанавливаем зависимости
    main_task()  # Выполняем основную задачу

if __name__ == "__main__":
    main()
